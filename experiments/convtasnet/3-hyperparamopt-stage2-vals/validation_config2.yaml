# ConvTasNet Stage 2 Validation â€” Config 2
# Source: major-sweep-31, best_val_sisdr=3.337
# Sweep: convtasnet-stage2-8k (71wtfegp)

data:
  dataset_type: polsess
  batch_size: 3
  num_workers: 1
  prefetch_factor: 2
  task: SB
  train_max_samples: 16000

model:
  model_type: convtasnet
  convtasnet:
    N: 256
    B: 256
    H: 512
    P: 3
    X: 8
    R: 4
    C: 2
    norm_type: gLN
    kernel_size: 16
    stride: 8
    causal: false
    mask_nonlinear: relu

training:
  seed: 42
  lr: 0.0004827607389798638
  weight_decay: 1.5867527330265665e-06
  grad_clip_norm: 4.297712834538782
  lr_factor: 0.39290664462444214
  lr_patience: 3
  num_epochs: 80
  use_amp: true
  amp_eps: 0.0001
  save_dir: checkpoints
  save_all_checkpoints: false
  early_stopping_patience: 15

  use_wandb: true
  wandb_project: polsess-separation
  log_level: INFO

  validation_variants: ["SER", "SE"]

  curriculum_learning:
    - epoch: 1
      variants: ["C", "R"]
    - epoch: 4
      variants: ["C", "R", "SR", "S"]
    - epoch: 10
      variants: ["R", "SR", "S", "SE", "ER", "E", "SER"]
      lr_scheduler: start
