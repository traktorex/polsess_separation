# ConvTasNet Hyperparameter Proxy Sweep (Subset 1k)
# Series 3: Fast proxy search on 1000 samples

program: train_sweep.py
method: bayes
metric:
  name: best_val_sisdr
  goal: maximize

early_terminate:
  type: hyperband
  min_iter: 5   # Check earlier on small data
  s: 2

parameters:
  # Fixed parameters
  config:
    value: experiments/convtasnet/sb_task_subset.yaml
  
  num_epochs:
    value: 30   # Fewer epochs needed for small data
  
  seed:
    values: [42]
  
  early_stopping_patience:
    value: 8   # Strict enough but allows recovering from noise
  
  # Hyperparameters to optimize (Widened Ranges)
  lr:
    distribution: log_uniform_values
    min: 5e-5     # 0.00005
    max: 2e-2     # 0.02 - explored higher for small data
  
  weight_decay:
    distribution: log_uniform_values
    min: 1e-7     # Lower floor for potentially less reg needed (or more, let bayes decide)
    max: 1e-3     # Higher ceiling to check heavy regularization
  
  grad_clip_norm:
    distribution: uniform
    min: 0.1      # Allow very strict clipping
    max: 20.0     # Allow very loose clipping
  
  lr_factor:
    distribution: uniform
    min: 0.2      # More aggressive drop
    max: 0.9      # Less aggressive drop
    
  # Added lr_patience as requested
  lr_patience:
    values: [2, 3, 4, 5]

project: polsess-thesis-experiments
name: 3-convtasnet-subset-proxy-sweep
